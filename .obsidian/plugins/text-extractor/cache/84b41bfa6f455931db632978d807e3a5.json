{"path":"_pdf_/金融工程/金融工程课件（12）.pdf","text":"金融工程 Financial Engineering 第十二章 期权定价的数值方法 2 目录  二叉树期权定价模型  蒙特卡罗模拟 3 一个简单的二叉树模型  股票的现价为 $20  三个月之后股票的价格或为 $22 或为 $18 Stock Price = $22 Stock Price = $18 Stock price = $20 4 Stock Price = $22 Option Price = $1 Stock Price = $18 Option Price = $0 Stock price = $20 Option Price=? 一份看涨期权 一份基于该股票的三个月到期的看涨期权，其执行价格为$ 21. 5  考虑一个资产组合: 持有 份股票，成为一份看涨期权的空头  当 22 – 1 = 18 or = 0.25，资产组合是无风险的。 22D – 1 18D 构造无风险资产组合 DDDD 6 资产组合的估值 ( 无风险利率为 12% )  无风险组合为: 持有 0.25份股票 成为一份看涨期权的空头  三个月后组合的价值为 22×0.25 – 1 = 4.50  组合在时刻0的价值为 4.5e – 0.12×0.25 = 4.3670 7 期权的估值  资产组合为： 持有 0.25份股票， 成为一份看涨期权的空头 组合在时刻 0 的价值为：4.3670 股票的价值是：5.000 (= 0.25×20 ) 从而，期权的价格为： 0.633 (= 5.000 – 4.367 ) 8 推广到一般情形  一个依赖于股票的衍生证券，到期时间为T， Su ƒu Sd ƒd S ƒ 9  考虑一个组合：持有 份股票，成为一份衍生证券的空头  当 满足下面的条件时，组合为无风险： SuD – ƒu = Sd D – ƒd ， or D    ƒu df Su Sd SuD – ƒu SdD – ƒd DD 10  组合在时刻 T的价值为 Su – ƒu  组合在时刻0 的价值为 (Su – ƒu )e–rT  组合在时刻0 的价值又可以表达为 S – f  从而 ƒ = S –(Su – ƒu )e–rT DDDDD 11  于是，我们得到 ƒ = [ p ƒu + (1 – p )ƒd ]e–rT 其中 p e d u d rT    12 Risk-Neutral Valuation  ƒ = [ p ƒu + (1 – p )ƒd ]e-rT  变量 p 和 (1 – p ) 可以解释为股票价格上升和下降的风险中 性概率  衍生证券的价值就是它的到期时刻的期望收益的现值 Su ƒu Sd ƒd S ƒ 13 最初例子的修正  由于p 是风险中性概率，所以 20e0.12×0.25 = 22p + 18(1 – p ); p = 0.6523  或者，我们可以利用公式 p d u d rT        e e0.12 0.25 0 9 1 1 0 9 0 6523 . . . . Su = 22 ƒu = 1 Sd = 18 ƒd = 0 S ƒ 14 期权的估值 期权的价值为： e–0.12×0.25 [0.6523×1 + 0.3477×0] = 0.633 Su = 22 ƒu = 1 Sd = 18 ƒd = 0 S ƒ 15 两步二叉树模型  每步长为3个月 20 22 18 24.2 19.8 16.2 16 欧式看涨期权的估值  在节点 B的价值 = e–0.12×0.25(0.6523×3.2 + 0.3477×0) = 2.0257  在节点 A的价值 = e–0.12×0.25(0.6523×2.0257 + 0.3477×0) = 1.2823 20 1.2823 22 18 24.2 3.2 19.8 0.0 16.2 0.0 2.0257 0.0 A B C D E F 17 一个看跌期权的例子：X＝52 50 4.1923 60 40 72 0 48 4 32 20 1.4147 9.4636 A B C D E F 18 美式期权该如何估值？ 50 5.0894 60 40 72 0 48 4 32 20 1.4147 12.0 A B C D E F 19 单步二叉树模型 20 证券价格的树形结构 21 参数的确定  在风险中性世界里：  所有可交易证券的期望收益都是无风险利率；  未来现金流可以用其期望值按无风险利率贴现。 参数 p 、 u 、 d 须满足：       22 2 2 2 2 2 2 1 11 1 rtSe pSu p Sd S t pS u p S d S pu p d u d  D    D        22  由以上条件可得：  期权价格为： rt t t ed p ud ue de   D D D       1 rt udf e pf p f D   23 二叉树图的结点  在 的情况下，节点会重合。在 时刻，证券价格有i + 1 种可能，一般表达式为 其中j = 0,1, ….i  如果假设 p = 0.5 ，则二叉树图中心线上的标的资产价格不再和中心 值相等，但其优点是概率始终不变。 1 u d  itD j i jSu d  24 倒推定价法  倒推定价法：从树型结构图的末端 T 时刻开始往回倒推，为期权 定价。  欧式期权：将 T 时刻期权价值的预期值在 ∆t 时间长度内以无风 险利率 r 贴现求出每一结点上的期权价值。  美式期权：在树型结构的每一个结点上，比较在本时刻提前执行期 权和继续再持有 ∆t 时间到下一个时刻再执行期权的价值，选择 较大者作为本结点的期权价值。 25 案例 12.1 ：美式看跌期权的二叉树定价  假设标的资产为不付红利股票，其当前市场价为 50 元, 波动率为每年 40% ，无风险连续复利年利率为 10% ，该 股票 5 个月期的美式看跌期权协议价格为 50 元，求该 期权的价值。 26  为了构造二叉树，我们把期权有效期分为五段，每段一 个月（等于 0.0833 年）。可以算出 1.1224 0.8909 0.5076 1 0.4924 t t rt ue de ed p ud p   D D D       2728 二叉树定价的一般过程：以美式看跌期权为例  把期权有效期划分为 N 个长度为 ∆t 的小区间， 和 分别为节点 (i, j) 处的标的资产价格 与期权价值;则 其中j=0,1,2,…..N  当时间区间划分趋于无穷大，可以求出美式看跌期权的准确价值。  一般将时间区间分成 30 步就可得到较为理想的结果。 ijf   1, 1 1,max , 1 j i j r t ij i j i jf X Su d e pf p f   D       max , 0 j N j Njf X Su d j i-judS 29 有红利资产期权的定价：支付连续红利率q  在风险中性条件下，标的资产价格的增长率应该为 ，因此式（ 12.2 ）的第一式变为：  相应有  式（ 12.3 ）后两式仍然成立： rq    1 r q te pu p d D     r q t ed p ud D    t t ue de   D D   30 有红利资产期权的定价：支付已知红利率  可通过调整在各个结点上的证券价格，算出期权价格；  如果时刻 i∆t 在除权日之前，则结点处证券价格仍为：  如果时刻 i∆t 在除权日之后，则结点处证券价格相应调整 为： 0,1...... j i jSu d j i   1 0,1...... j i jS u d j i  31  若在期权有效期内有多个已知红利率，则 i∆t 时刻结点的相 应的证券价格为：  （ 为 0 时刻到 i∆t 时刻之间第 k 个除权日的红利支付 率）   1 1   K j i j kS u dk 32 有红利资产期权的定价：支付已知红利数额 33  在已知红利额的情况下, 为了使得二叉树的节点重合减少计 算量, 我们可以将证券价格分为两个部分：一部分是不确定 的；另一部分是期权有效期内所有未来红利的现值。 34  假设在期权有效期内只有一次红利，除息日τ在 k∆t到 (k + 1)∆t 之间，则在 i∆t 时刻不确定部分的价值为：  当 时  当 时 其中， D 表示红利。    S i t S i t  D  D     r i tS i t S i t De   D D  D it Dit D 35  因此，我们需要先构造不含红利的价格树图，之后再加上未来红 利的现值。在 时刻：  当 时， 这个树上每个结点对应的证券价格为：  当 时，这个树上每个结点对应的证券价格为： 其中, 为零时刻 的值。相应地使用的 是 的 波动率。 tiD * 0 0,1...... j i jS u d j i    * 0 0,1...... r i tj i jS u d De j i   D 0S  S S it Dit D 36 构造树图的其他方法和思路  p = 0.5 的二叉树图  三叉树图  控制方差技术  适应性网状模型 37 p = 0.5 的二叉树图  在确定参数 u ，p ，d 时不再假设 ，而令 p = 0.5 ， 可得：  该方法优点在于无论 ∆t 和 σ 如何变化，概率总是不变的。 1 u d  2 2 2 2 r q t t r q t t ue de        D  D     D  D    38 三叉树图  每一个时间间隔 ∆t 内证券价格有三种运动的可能：  从开始的 S 上升到原先的 u 倍，即到达 Su ；  保持不变，仍为 S ；  下降到原先的 d 倍，即 Sd 。 3940  一些相关参数： 3 2 2 2 2 1 1 12 2 6 1 12 2 6 2 3 t d u m ue d u t p r q t p r q p      D  D       D       41 控制方差技术  基本原理：期权 A 和期权 B 的性质相似，我们可以得到期权 B 的解析定价公式，而只能得到期权 A 的数值方法解，这时就可以 利用期权 B 解析法与数值法定价的误差来纠正期权 A 的数值法 的定价误差。  用 代表期权 B 的真实价值（解析解）， 表示关于期权 A 的较优估计值， 和 表示用同一个二叉树、相同的蒙特卡 罗模拟或是同样的有限差分过程得到的估计值。 Bf Afˆ Afˆ Bf 42  假设 则期权 A 的更优估计值为 BABAf f f f    ABABf f f f     43 适应性网状模型  在使用三叉树图为美式期权定价时，在接近到期的执行价格 附近，用高密度的树图来取代原先低密度的树图。  在树图中那些提前执行可能性较大的部分，将一个时间步长 ∆t 进一步细分，如分为 ，每个小步长仍然采用相同的三 叉树定价过程。 4 tD 44 蒙特卡罗模拟 45 随机路径  在风险中性世界中，为了模拟路径 我们把期权的有效期分为 N 个长度为 ∆t 的时间段，则上 式的近似方程为： 或  dS r q Sdt Sdz       2 ln ln 2 S t t S t r q t t     D     D  D      2 exp 2 S t t S t r q t t     D    D  D  46  其中 S(t) 代表 t 时刻 S 的价值, ε 是从标准正态分布 中抽取的一个随机样本。  通过 N 个正态分布的随机抽样就可以组建一条资产价格的 蒙特卡罗模拟样本路径，并得到相应的回报值。  重复以上的模拟至足够大的次数，计算回报值的平均值，贴 现后就得到了期权的期望值和估计的标准差。 47  用 ln S 比 S 准确。  用蒙特卡罗模拟为欧式期权定价时，由于期权回报只与期权 到期时刻的股票价格有关，可以让 t + ∆t = T 并直接利用 公式 ln S 的随机过程来求 T 时刻的股票价格。  Paul Glasserman, Monte Carlo methods in financial engineering, Springer-Verlag New York,2003 48 案例 12.2 ：蒙特卡罗模拟的路径模拟  假设无红利的股票价格服从式（ 12.9 ），年预期收益率 r = 14% ，收益波动率为 σ = 20% ，时间步长为 ∆t = 0.01 年，则 根据式（ 12.9 ）有  假设股票价格的初始值为 20 ，ε的第一个样本值为 0.52 ，则 第一个步长结束后，  第二步开始时的股票价格上升为 20.236 ，这次抽到的 ε 为 1.44 ，因此 0.14 0.01 0.2 0.01S S SD   0.0014 20 0.02 20 0.52 0.236SD      0.0014 20.236 0.02 20.236 1.44 0.611SD       49  下表给出了案例 12.2 中模拟的路径： 50 ε 的产生  ε 是服从标准正态分布的一个随机数。  如果只有一个单变量，则可以通过下式获得： 其中 是相互独立的 0 到 1 均匀分布的随机 数。  在 Excel 中， NORMSINV(RAND()) 可以生成标准正态分布 的随机样本。 12 1 6i i R   1 12iRi 51 模拟运算次数的确定  如果对估计值要求 95% 的置信度，则期权价值应满足  其中， M 为进行运算的次数， µ 为均值， ω 为标准差。 1.96 1.96 f MM      52 主要优点和主要缺点  主要优点：  应用简单，无需深刻理解定价模型  适用情形广泛  欧式衍生产品  回报路径依赖  回报取决于多个标的资产  主要缺点：  难以处理提前执行的情形  为了达到一定的精确度，一般需要大量模拟运算。 53 谢谢！","libVersion":"0.3.2","langs":""}